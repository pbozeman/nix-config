#!/bin/sh

set -e

if [ -z "$1" ]; then
  echo "usage: tma <session-name>"
  exit 1
fi

session="$1"

# If session exists, just attach
if tmux has-session -t "$session" 2>/dev/null; then
  exec tmux attach -t "$session"
fi

# Create new session - use systemd-run on Linux
case "$(uname)" in
  Linux)
    exec systemd-run --user --scope tmux new-session -s "$session"
    ;;
  *)
    exec tmux new-session -s "$session"
    ;;
esac
